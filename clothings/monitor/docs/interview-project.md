
# 项目知识 #

- 服饰供应链
	* 项目介绍
	* 发货流程详解
	* 技术难点
	* 收货流程详解
	* 盘点流程
	
## 	服饰供应链  ##

### 项目介绍  ###
	
	服饰供应链系统主要是利用RFID技术对客户的工厂、仓库、门店收发货环节，实现单品级的管理。实现工厂送审、仓库收发或、门店收发盘业务的高效精准管理。系统业务分为三个场景：
- 工厂端：主要功能有、标签绑定解绑、工厂装箱发货
- 仓库端：采购收货、采购退货、配货到门店、退仓等功能
- 门店端：	收货、退仓、盘点、绑定、解绑等功能

	系统主要分为7个服务，一个web平台、一个手持机、一个net桌面：
- 基础服务：用户添加、登录、权限管理
- 基础档案：门店档案、商品档案
- 标签服务：商品标签库存管理、绑定、解绑、标签生命周期管理。其中商品标签库存数据会比较大，目前采用EPC hash算法进行分库分表，将EPC商品信息数据缓存到Redis，针对EPC的聚合查询会用到ES、库存查询会用到ES
- 工厂服务：工厂收发货，采购订单管理
- 仓库服务：仓库采购入库、仓库横调、仓库退货到工厂、仓库配货到门店
- 门店服务：门店收货、门店退货、门店横调
- 盘点服务：仓库盘点、门店盘点

	我的职责：主导系统设计、服务划分、数据库设计、提供核心技术支持，工厂发货，仓库收货，标签生命周期。

### 工厂发货流程详解  ###

- 1、工厂新建空箱  -> 扫描EPC商品  -> EPC校验是否可以装箱  -> 提交批量EPC -> 完成装箱
- 2、工厂送审到外部系统  -> 外部系统审核通过后 -> 回收到外部通知，即可以送货，工厂确认送货

	此处、工厂确认送货后，会往仓库收货发送MQ通知，通知MQ生成收货单、箱、EPC数据。仓库端也可以选择通过发货端来一键生成收货数据.若MQ消息消费失败。
	生成收货数据时，我们会批次生成、每个EPC、每箱、每单都会有记录状态是否生成完成，若没有生成完成，可以继续生成，直到完整生成为止。
	会以多线程方式去生成某单下各个款数量，提高生成收货数据时间。同时利用ZK分布式锁对每个单下的每个款进行锁定，防止多个进程同时生成。

### 仓库收货流程详解  ###	
	
- 1、仓库扫描箱条码收货  -> 进入箱详情  -> 进入收货扫描界面  -> 批量提交  -> 后台修改收货EPC信息状态
- 2、收齐箱之后  -> 收齐单  -> 将该单 发回外部系统确认  -> 收到通知后  -> 改为已审核状态  -> 同时修改仓库单、箱、EPC状态	

	修改发货单、箱、EPC状态、也是利用MQ加多线程加分布式锁共同协调完成的，也可以多次点击操作，接口具有幂等性。	




