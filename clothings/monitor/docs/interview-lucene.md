
# lucene #

- lucene索引文件格式(1)
- lucene索引文件格式(2)


## lucene索引文件格式(1) ##

- 基本概念

### 基本概念  ###

Lucene索引结构是有层次结构的，主要分以下几个层次：

比如下面是epc文件夹下文件列表
	_0.fdt
	_0.fdx
	_0.fnm
	_1.fdt
	_1.fdx
	_1.fnm
	segments.gen
	segments_5

- 索引(index)
	* 	在Lucene中，一个索引是放在一个文件夹中的。
	*	一个文件夹中的所有文件构成了一个索引。
- 段(Segment) 
	* 	一个索引可以包含多个段，段与段之间独立，添加新文档可以生成新的段，不同的段可以合并。
	*	如上图，具有相同前缀的文件属同一个段，上面只有两个段‘_0’和‘_1’段。
	*	segments.gen和segments_5是段的元数据文件，它们保存了段的属性信息。
- 文档(document)
	*	文档是我们建索引的基本单位，不同的文档保存在不同段中(?)，一个段可以包含多个文档。
	*	新添的文档是保存在新的段中，随着段的合并，不同的段合并为一个段。	
- 域(Field)
	*	 一篇文档包含不同类型的信息，可以分开索引，比如标题，时间，作者，正文等。
	*	不同的域索引方式可以不同，在真正解析域的存储时，我们在详细解析。
- 词(Term)
	*	词是索引的最小单位，是经过词法分析和语言处理之后的字符串。	

Lucene索引结构中，既保存了正向信息，又保存了反向信息。

- 正向信息：
	*	按层次保存了索引结构，一直到词的关系：索引(Index) -> 段(Segment) -> 文档(Document) -> 域(Field) -> 词(Term)
	*	包含正向信息的文件：
		**	segment_n: 表示此索引包含了多少段，每个段包含了多少文档。
		**	xxx.fnm：表示此段包含了多少个域，每个域的名称及索引方式。
		** 	xxx.fdt、xxx.fdx：保存了此段包含的所有文档，每篇文档包含了多少域，每个域保存了那些信息。 
		** 	XXX.tvx，XXX.tvd，XXX.tvf：保存了此段包含的所有文档，每篇文档包含了多少域，每个域保存了那些信息。 

- 反向信息：
	*	保存了词到倒排索引的映射：词(Term) --> 文档(Document)
	*	包含反向信息的文件：
		


