
# 07-事物

## 7.1 认识事物

### 7.1.1 概述

在事物中一般有以下4个概念：

- 原子性
- 一致性
- 隔离性
- 持久性

我们先具体介绍事物的这四个概念。

**原子性**：即事物中任何一个SQL执行失败，已经执行成功的SQL必须撤销，数据库回到事物执行前的状态。

**一致性**：比如一个唯一索引的字段，事物更新之前是唯一的，新增或修改记录，该字段仍然是唯一的。

**隔离性**：隔离性还有其他称呼，如并发控制，锁等。事物隔离性要求每个读写事物的对象，对其他事物操作的对象相互隔离，即该事物提交前对其他事物都不可见。通常使用锁来实现，当前数据库都提供了粒度锁，允许事物仅锁住一个实体对象的子集，即行锁，以此来提供系统的并发。

**持久性**：事物一旦提交，其结果是永久性的。即使数据库宕机，也能通过某些方法将数据恢复，前提是磁盘没有损坏。

### 7.1.2 分类 

从事物理论的角度可以把事物分为以下几种类型：

- 扁平事物
- 带有保存点的扁平事物

## 7.2 事物的实现

