
## 分布式知识梳理

- Dubbo的底层实现原理和机制  (已理解)
- 描述一个服务从发布到消费的详细过程 (已理解)
- 分布式系统怎么做服务治理
- Dubbo服务请求失败怎么处理
- 接口幂等性的概念
- 消息中间件如何解决消息丢失的问题
- 重连机制会不会造成错误
- 对分布式事物的理解
- 如何设计一个高并发系统？
- 如何实现负载均衡, 有哪些算法可以实现
- Zookeeper的原理是什么,选举的原理是什么
- ZK的选举策略
- Zookeeper原理和适用场景
- Zookeeper的watcher机制
- redis/zk节点宕机处理
- 数据的垂直拆分与水平拆分
- 列举出 你能想到的数据库分库分表策略，分库分表后如何解决全表查询的问题。

### 分布式系统怎么做服务治理 ###

- 引入服务治理是为了对整体RPC调用进行集中化管理，减少重复劳动，避免手动配置产生的问题。
- 服务治理的3个核心动作：注册，订阅，变更下发
- 服务的自动注册、服务的自动发现、服务的变更下发(增加机器，或减少机器)

### 服务治理扩展 ###
- 基于版本号的服务管理，可用于灰度发布
- 请求的复制回放，可用于基于真实的流量压测
- 更灵活的负载均衡和路由策略
- 内置熔断操作，避免整个分布式系统产生雪崩效应
- 调用链路生成, 方便出现异常时，能够分析是出现问题的机器
- 接口调用统计, 用于更好的监控各服务的资源利用率，以及及时增减服务

### dubbo超时问题 ###

- 超时是指针对消费端还是服务端
- 超时在哪设置
- 超时设置的优先级是什么
- 超时的实现原理
- 超时解决的问题是什么

#### 超时是指针对消费端还是服务端  ####

- 如果针对消费端：那么当消费端发起一个请求后，如果在规定的时间内未得到服务端的响应则直接返回超时异常，但此时服务端代码依然正常运行。
- 如果针对服务端：当消费端发起一个请求后，服务端在方法执行到指定的时间内若未完成，则返回一个超时异常给客户端

#### 超时在哪设置  ####

- 消费端：全局设置、接口设置、方法设置（只有xml配置才有）
- 服务端：全局设置、接口设置、方法设置（只有xml配置才有）

#### 超时设置的优先级是什么  ####

- 服务端超时设置时消费端的缺省设置
- 综合是: 消费端 > 服务端
- 客户端方法级 > 服务端方法级 > 客户端接口级 > 服务端接口级 > 客户端全局 > 服务端全局

#### 超时解决的问题是什么  ####

- 对调用服务设置超时时间，避免某种原因导致线程被长时间占用，最终出现线程池用完，返回拒绝服务异常。

#### Dubbo服务请求失败怎么处理  ####

- 如果有重试机制，dubbo会将请求路由至其他服务
- 没有重试机制消费端直接返回服务请求失败异常
- 首先这个失败是什么异常？是由网络引起的失败吗

### 接口幂等性的概念 ###

- 目标：接口调用多次跟一次结果是一样的。比如下单，由于网络问题，用户重复点了几次，但应该只能算成功一次。
- 全局惟一操作ID
- 乐观锁机制
- 惟一索引
- 案例：装箱发货时，提交EPC操作应该是幂等性操作，可以在进入扫描EPC界面时，提供一个提交EPC操作的ID，当提交时校验ID是否小于初始值
	key为：EPC:{MODULE}:{USERID}, value为 1, 失效时间为1天





