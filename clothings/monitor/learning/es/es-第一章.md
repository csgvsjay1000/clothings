
## 第一章

### 1、ES的基本概念和原理 ###

	ES是近实时的分布式搜索分析引擎，集群支持上百个节点，相比HDFS支持上千个节点来说规模略小，因此ES适合存储中等数据量的业务，而不是海量。
	
### 1.1、索引结构 ###

	在实际使用中，有不同_type需求时，应该建立不同的_index。删除过期老化数据应该以索引为单位？而不是_type或_id。一个_index中应该只有一个_type。
	已_id为单位的删除文档，不会立即释放空间，只会在Lucene分段合并时才会真正从磁盘删除.

### 1.2、分片(shard) ###

	分片的目的是分割巨大索引，让读写可以并行操作。当集群扩容或缩小规模时，ES会自动在各个阶段中迁移分片，使数据仍然均匀分布。
当索引数据较大时，可以考虑周期性的创建索引，定期删除老的索引。


### 1.3、段合并 ###

	ES每秒清空一次写缓存，将这些数据写入文件,这个过程称为refresh,每次refresh会创建一个新的Lucene段。但分段太多会导致消耗文件句柄，内存。每个搜索请求都要轮流检查每个段，查询完再对结果进行合并，所以段越多搜索越慢。因此需要定期将段合并为大段，


### 4、市场上消息队列比较 ###

- ActiveMQ 性能较差，支持万级吞吐量,不推荐使用
- RabitMQ 并发能力强(指可以支持大量客户端连接)，支持万级吞吐量，延时很低微妙级us,其他都是毫秒级ms
- RocketMQ 支持百万级吞吐量,理论上不丢失消息, 阿里出品
- KafkaMQ 支持百万级吞吐量，理论上不丢失消息, 大数据领域的标准
